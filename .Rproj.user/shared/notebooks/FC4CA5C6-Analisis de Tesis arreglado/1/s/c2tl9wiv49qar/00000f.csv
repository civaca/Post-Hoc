"0","data3 <- mutate(data2, IMC_1 = obesidad(IMC_1))"
"0",""
"0","tapply(data3[[28]], data3[[52]], length)"
"1","Peso_inic_embarazo
"
"1","  0 "
"1","  1 "
"1","
"
"1","385 "
"1"," 85 "
"1","
"
"0","# This is with dyplyr"
"0",""
"0",""
"0","TC <- data3 %>%"
"0","  group_by(data3[28], IMC_1 ) %>% "
"0"," summarize(count = n()) %>%"
"0","    pivot_wider(names_from = 1, values_from = count) %>% "
"0","    ungroup() %>%"
"0","    select(-1) %>%"
"0","    chisq.test()"
"0",""
"0",""
"0",""
"0",""
"0","TC <- data2 %>%"
"0","  mutate(IMC_1 = obesidad(IMC_1)) %>%"
"0","  filter(!is.na(IMC_1))"
"0",""
"0","CrossTable(TC[[28]], unlist(TC$IMC_1), format = ""SPSS"")"
"1","
"
"1","   Cell Contents
"
"1","|-------------------------|
"
"1","|                   Count |
"
"1","| Chi-square contribution |
"
"1","|             Row Percent |
"
"1","|          Column Percent |
"
"1","|           Total Percent |
"
"1","|-------------------------|
"
"1","
"
"1","Total Observations in Table: "
"1"," "
"1","451"
"1"," "
"1","
"
"1","
"
"1","            "
"1"," "
"1","|"
"1"," "
"1","unlist(TC$IMC_1)"
"1"," "
"1","
"
"1","    TC[[28]]"
"1"," | "
"1",""
"1","       0"
"1","  | "
"1","       1"
"1","  | "
"1",""
"1","Row Total"
"1"," | "
"1","
"
"1",""
"1",""
"1","-------------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","
"
"1","           1"
"1"," | "
"1",""
"1","      87"
"1","  | "
"1","      24"
"1","  | "
"1","     111"
"1","  | "
"1","
"
"1",""
"1",""
"1","            "
"1"," | "
"1",""
"1","   0.203"
"1","  | "
"1","   0.944"
"1","  | "
"1",""
"1","         "
"1"," | "
"1","
"
"1",""
"1",""
"1","            "
"1"," | "
"1",""
"1","  78.378"
"1","% | "
"1","  21.622"
"1","% | "
"1","  24.612"
"1","% | "
"1","
"
"1",""
"1",""
"1","            "
"1"," | "
"1",""
"1","  23.450"
"1","% | "
"1","  30.000"
"1","% | "
"1",""
"1","         "
"1"," | "
"1","
"
"1",""
"1",""
"1","            "
"1"," | "
"1",""
"1","  19.290"
"1","% | "
"1","   5.322"
"1","% | "
"1",""
"1","         "
"1"," | "
"1","
"
"1",""
"1",""
"1","-------------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","
"
"1","           2"
"1"," | "
"1",""
"1","     284"
"1","  | "
"1","      56"
"1","  | "
"1","     340"
"1","  | "
"1","
"
"1",""
"1",""
"1","            "
"1"," | "
"1",""
"1","   0.066"
"1","  | "
"1","   0.308"
"1","  | "
"1",""
"1","         "
"1"," | "
"1","
"
"1",""
"1",""
"1","            "
"1"," | "
"1",""
"1","  83.529"
"1","% | "
"1","  16.471"
"1","% | "
"1","  75.388"
"1","% | "
"1","
"
"1",""
"1",""
"1","            "
"1"," | "
"1",""
"1","  76.550"
"1","% | "
"1","  70.000"
"1","% | "
"1",""
"1","         "
"1"," | "
"1","
"
"1",""
"1",""
"1","            "
"1"," | "
"1",""
"1","  62.971"
"1","% | "
"1","  12.417"
"1","% | "
"1",""
"1","         "
"1"," | "
"1","
"
"1",""
"1",""
"1","-------------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","
"
"1","Column Total"
"1"," | "
"1",""
"1","     371"
"1","  | "
"1","      80"
"1","  | "
"1","     451"
"1","  | "
"1","
"
"1",""
"1",""
"1","            "
"1"," | "
"1",""
"1","  82.262"
"1","% | "
"1","  17.738"
"1","% | "
"1",""
"1","         "
"1"," | "
"1","
"
"1",""
"1",""
"1","-------------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","-----------"
"1","|"
"1","
"
"1","
"
"1"," "
"1","
"
"0","TC3 <- 1"
"0","i <- 1"
"0","while (i <= 4) {"
"0","  TC <- data3 %>%"
"0","    mutate(IMC_1 = obesidad(IMC_1)) %>%"
"0","    group_by(data3[26 + i], data3[52], ) %>%"
"0","    summarize(count = n(), .groups = ""keep"") %>%"
"0","    na.omit() %>%"
"0","    pivot_wider(names_from = 1, values_from = count) %>%"
"0","    filter(!is.na(IMC_1)) %>%"
"0","    ungroup() %>%"
"0","    select(-1) %>%"
"0","    chisq.test()"
"0","  TC3[i] <- (TC$p.value)"
"0",""
"0","  i <- i + 1"
"0","}"
"0","print(TC3)"
"1","[1]"
"1"," 0.1335143"
"1"," 0.2755159"
"1"," 1.0000000"
"1"," 1.0000000"
"1","
"
"0","# this is better,"
"0",""
"0","chilist <- vector()"
"0","colnames <- vector()"
"0",""
"0","for (i in 1:4) {"
"0","  chilist[i] <- (chisq.test(table(unlist(data3[[26 + i]]), unlist(data3[52]))))$p.value"
"0","  colnames[i] <- names(data3[26 + i])"
"0","}"
"0",""
"0",""
"0","for (i in 5:12) {"
"0","  data3 <- mutate(data2, IMC_1 = obesidad(IMC_1), enf = enfermedad(data3[11 + i]))"
"0","  chilist[i] <- chisq.test(table(unlist(data3$enf), unlist(data3$IMC_1)))$p.value"
"0","  colnames[i] <- names(data3[11 + i])"
"0","}"
"0","for (i in c(13, 15, 16, 17)) {"
"0","  chilist[i] <- (chisq.test(table(unlist(data3[[31 + i]]), unlist(data3[52]))))$p.value"
"0","  colnames[i] <- names(data3[31 + i])"
"0","}"
"0",""
"0",""
"0",""
"0",""
"0",""
"0","obesidadchi <- sapply(chilist, function(x) {"
"0","  return(round(x, digits = 4))"
"0","})"
"0","print(as.data.frame(obesidadchi, colnames))"
